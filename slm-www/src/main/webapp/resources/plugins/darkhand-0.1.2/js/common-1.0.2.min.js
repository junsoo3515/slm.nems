(function(a){if(typeof define==="function"&&define.amd){define(["jquery","jqGrid.setting"],a)}else{a(jQuery,jqFn)}}(function(jQuery,jqFn){function getCookie(name){var from_idx=document.cookie.indexOf(name+"=");if(from_idx!=-1){from_idx+=name.length+1;var to_idx=document.cookie.indexOf(";",from_idx);if(to_idx==-1){to_idx=document.cookie.length}return unescape(document.cookie.substring(from_idx,to_idx))}}function setCookie(name,value,expiredays){var todayDate=new Date();todayDate.setDate(todayDate.getDate()+expiredays);todayDate.setHours(0,0,-1);document.cookie=name+"="+escape(value)+"; path=/; expires="+todayDate.toGMTString()+";"}function callFunction(fnc){if(fnc!=null){var filtersString=JSON.stringify(fnc,function(k,v){if(typeof v==="function"){return v.toString()}return v});var retFunc=JSON.parse(filtersString,function(k,v){if(v&&typeof v==="string"&&v.substr(0,8)=="function"){var startBody=v.indexOf("{")+1;var endBody=v.lastIndexOf("}");var startArgs=v.indexOf("(")+1;var endArgs=v.indexOf(")");return new Function(v.substring(startArgs,endArgs),v.substring(startBody,endBody))}return v});return retFunc()}}function enterSend(val){var retVal=true;jQuery.each(val,function(index,data){jQuery("#"+data.ret).off("click").on("click",function(e){e.stopPropagation();if(data.script!=null){var tmps=callFunction(data.script);retVal=(tmps===undefined?true:tmps)}if(retVal===true){callFunction(data.state)}return false});data.chk.not("textarea").off("keydown").on("keydown",function(evt){if(evt.keyCode===13){if(data.script!=null){var tmps=callFunction(data.script);retVal=(tmps===undefined?true:tmps)}if(retVal===true){if(data.state!=null){jQuery("#"+data.ret).off("click").on("click",function(){callFunction(data.state)}).click()}}return false}})})}function focusCSS(){jQuery(":input, select").live("focus",function(){jQuery(this).addClass("focus")}).live("blur",function(){jQuery(this).removeClass("focus");jQuery(this).addClass("focusnot")})}function loadingImg(panelID,targetID,state,v){if(v===undefined){v=500}switch(state){case true:var padingTop=(jQuery("#"+targetID).height()/2)-20;var padingLeft=(jQuery("#"+targetID).width()/2)-20;jQuery("#"+panelID+" #loadingImg").css({position:"relative",left:padingLeft+"px",top:padingTop+"px"});jQuery("#"+panelID).css({position:"absolute",left:jQuery("#"+targetID).offset().left+"px",top:jQuery("#"+targetID).offset().top+"px",width:jQuery("#"+targetID).width()+"px",height:jQuery("#"+targetID).height()+"px"}).fadeIn(v);break;case false:jQuery("#"+panelID).fadeOut(v);break}}function clearElement(ele,isForm){if(isForm===undefined){isForm=true}var eles=(jQuery.type(ele)==="string"?jQuery(ele):ele);if(isForm===true){eles=eles.find(":input")}else{eles=eles.find("[id]")}eles.each(function(){if(isForm===false&&this.type===undefined){this.type="html"}switch(this.type){case"select-multiple":case"select-one":this.selectedIndex=0;break;case"checkbox":case"radio":this.checked=false;break;case"html":jQuery(this).html("");break;default:jQuery(this).val("");break}})}function setHtmlValues(obj){jQuery.each(obj,function(k,v){jQuery("#"+k).html(v)})}function setValues(obj,pattern,prefix,parentID){if(prefix===undefined){prefix=""}jQuery.each(obj,function(k,v){var ids=prefix+k;if(pattern!==undefined){jQuery.each(ids.match(pattern),function(idx,data){ids=ids.replace(data,data.toUpperCase().substring(1))})}var o=jQuery("#"+ids);if(o.val()===undefined){jQuery("#"+parentID+" input:radio").filter("[name='"+ids+"'][value='"+v+"']").prop("checked",true).change()}else{o.val([v]);if((o.attr("type")==="checkbox"&&o.is(":checked"))||o.find("option").size()>0){o.change()}}})}function setTextValues(obj){jQuery.each(obj,function(k,v){jQuery("#"+k).text(v)})}function changeKeys(obj,cObj,pattern,prefix){var retObj={};if(pattern!==undefined){jQuery.each(obj,function(k,v){var ids=k;var resultArray=ids.match(pattern);jQuery.each(resultArray,function(idx,data){ids=ids.replace(data,"_"+data.toLowerCase())});ids=ids.replace(prefix,"");retObj[ids]=v})}if(cObj!==null){jQuery.each(cObj,function(index,data){retObj[data.v]=obj[data.k]})}return retObj}function setSelectOpt(obj,strFirstMsg,jsonData,selVal,jsonType){if(selVal==undefined){selVal=""}if(jsonType===undefined){jsonType="A"}if(strFirstMsg!==null){obj.append("<option value=''>"+strFirstMsg+"</option>")}switch(jsonType){case"A":jQuery.each(jsonData,function(idx,data){obj.append("<option value='"+data.id+"'>"+data.val+"</option>")});break;case"B":var stateId,newOptions="";for(stateId in jsonData){if(jsonData.hasOwnProperty(stateId)){obj.append("<option value='"+stateId+"'>"+jsonData[stateId]+"</option>")}}break}if(selVal!==""){obj.val(selVal)}}function changeSelOpt(url,fcData,fcSuccess,fcError,asyncOpt){var ajaxType="GET";if(fcData!==undefined){if(fcData!==null){ajaxType="POST"}}if(fcError===undefined){fcError=ajaxError}if(asyncOpt===undefined){asyncOpt=false}jQuery.ajax({url:url,type:ajaxType,dataType:"json",data:(ajaxType==="GET"?{}:JSON.stringify(fcData)),contentType:"application/json; charset=utf-8",async:asyncOpt,success:fcSuccess,error:fcError})}function setjqGridOpt(strFirstMsg,jsonData){var retV={};if(strFirstMsg!=null){retV[""]=strFirstMsg}jQuery.each(jsonData,function(idx,data){retV[data.id]=data.val});return retV}function targetFrame(listFunc){if(listFunc!=null&&listFunc!=""){return'<iframe id="upload_target" name="upload_target" src="" style="width:0;height:0;border:0px solid #fff;" onload="'+listFunc+'()"></iframe>'}else{return'<iframe id="upload_target" name="upload_target" src="" style="width:0;height:0;border:0px solid #fff;"></iframe>'}}function setOSXModal(data,target,jong,opt){if(target===undefined){target=null}if(jong===undefined){jong=0}if(opt===undefined){opt={cName:"blackgloss",pos:"middle-center",tabInfoID:null,onClose:function(){}}}else{if(opt.tabInfoID!==undefined){var tabs=jQuery("#"+opt.tabInfoID);var btnTab=tabs.find("li#buttonTab");if(btnTab.length>0){btnTab.hide();opt.onClose=function(){tabs.find(".nav-tabs li#errorTab").remove();btnTab.show()}}else{opt.onClose=function(){tabs.find(".nav-tabs li#errorTab").remove()}}jQuery(".nav-tabs",tabs).append("<li id='errorTab' class='pull-right'><div class='alert tab-right span12' style='margin:0; padding:7px;'></div></li>")}else{opt.tabInfoID=null}}switch(jong){case 0:case 1:if(jong===0){jQuery("."+opt.pos).notify({message:{text:data},type:opt.cName,tabID:opt.tabInfoID,onClose:opt.onClose}).show()}else{alert(data)}if(target!=null){switch(target.get(0).tagName){case"DIV":jQuery("#"+opt.tabInfoID+" a[href='#"+target.get(0).id+"']").tab("show");break;case"INPUT":if(target.attr("type")!=="hidden"&&target.attr("disabled")===undefined){target.focus()}break}}break;case 2:if(target!=null){target.parents(".control-group").addClass("error");target.focus()}break;case 3:break}}function nowDate(gubun,milliSec){var resDate;if(milliSec===undefined){resDate=new Date()}else{resDate=new Date(milliSec)}var resMM=(new String(resDate.getMonth()+1).length==1)?"0"+(resDate.getMonth()+1):(resDate.getMonth()+1);var resDD=(new String(resDate.getDate()).length==1)?"0"+resDate.getDate():resDate.getDate();return resDate.getFullYear()+gubun+resMM+gubun+resDD}function termDate(data,jong,term,gubun){var resDate,realDate,tmps;data=data.replace(eval("/\\"+gubun+"/g"),"");switch(jong){case"y":tmps=jsAddYear(data,term);resDate=new Date(tmps.substring(0,4),tmps.substring(4,6)-1,tmps.substring(6,8));break;case"m":tmps=jsAddMonths(data,term);resDate=new Date(tmps.substring(0,4),tmps.substring(4,6)-1,tmps.substring(6,8));break;case"d":realDate=new Date(parseInt(data.substring(0,4)),parseInt(data.substring(4,6))-1,parseInt(data.substring(6,8)));resDate=new Date(realDate.valueOf()+(1000*24*60*60*term));break}var resMM=(new String(resDate.getMonth()+1).length==1)?"0"+(resDate.getMonth()+1):(resDate.getMonth()+1);var resDD=(new String(resDate.getDate()).length==1)?"0"+resDate.getDate():resDate.getDate();return resDate.getFullYear()+gubun+resMM+gubun+resDD}function isMaxTermDate(fromdt,todt,term){var sDT,eDT;var gubun="-";fromdt=fromdt.replace(eval("/\\"+gubun+"/g"),"");todt=todt.replace(eval("/\\"+gubun+"/g"),"");sDT=new Date(fromdt.substring(0,4),Number(fromdt.substring(4,6))-1,Number(fromdt.substring(6,8)));eDT=new Date(todt.substring(0,4),Number(todt.substring(4,6))-1,Number(todt.substring(6,8)));if(eDT.getTime()<sDT.getTime()){setOSXModal("검색종료일이 검색 시작일 보다 크게 설정 되어 있습니다.");return false}if((eDT.getTime()-sDT.getTime())/1000/60/60/24>term){setOSXModal("최대 검색 기간은 "+term+"일을 초과할 수 없습니다.");return false}return true}function jsAddYear(startDt,plusYear){var rtnValue="",yyyy=startDt.substring(0,4),mm=startDt.substring(4,6),dd=startDt.substring(6,8);var newYyyy=(Number(yyyy)+Number(plusYear));var isYoonYear=false;if((eval(newYyyy)%4)===0){isYoonYear=true}if((eval(newYyyy)%100)===0){isYoonYear=false}if((eval(newYyyy)%400)===0){isYoonYear=true}if((mm==="02")&&(dd==="29")&&!isYoonYear){dd="28"}rtnValue=String(newYyyy)+mm+dd;return rtnValue}function jsAddMonths(startDt,plusMonth){var rtnValue="",yyyy=startDt.substring(0,4),mm=startDt.substring(4,6),dd=startDt.substring(6,8),newMm=null;if((Number(mm)+Number(plusMonth))>12){yyyy=String(Number(yyyy)+1);newMm=Number(mm)+Number(plusMonth)-12}else{if((Number(mm)+Number(plusMonth))<0){yyyy=String(Number(yyyy)-1);newMm=12+(Number(mm)+Number(plusMonth))}else{newMm=Number(mm)+Number(plusMonth)}}var isYoonYear=false;if((eval(yyyy)%4)===0){isYoonYear=true}if((eval(yyyy)%100)===0){isYoonYear=false}if((eval(yyyy)%400)===0){isYoonYear=true}if(isYoonYear){if((newMm==="02")&&(dd==="30"||dd==="31")){dd="29"}}else{if((newMm==="02")&&(dd==="29"||dd==="30"||dd==="31")){dd="28"}}if(Number(newMm)<10){newMm=String("0"+newMm)}rtnValue=yyyy+""+newMm+""+dd;return rtnValue}function leadingZeros(n,ditis){var zero="";n=Number(n).toString();if(n.length<ditis){for(var i=0;i<ditis-n.length;i++){zero+="0"}}return zero+n}function comma(str){str=String(str);return str.replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")}function uncomma(str){str=String(str);return str.replace(/[^\d.]+/g,"")}function ajaxError(jqXhr,textStatus,errorThrown){if(textStatus===undefined){textStatus=""}if(errorThrown===undefined){errorThrown=""}console.log("Error '"+jqXhr.status+"' (textStatus: '"+textStatus+"', errorThrown: '"+errorThrown+"')")}function addRow(gridID,initData,afterFunc){if(gridID!==undefined){if(initData===undefined){initData={}}var dataGrid=jQuery("#"+gridID);var rid=jQuery.jgrid.randId();dataGrid.jqGrid("addRow",{rowID:rid,initdata:initData});jQuery("tr#"+rid+" :input[class='editable']").addClass("col-md-12").removeAttr("style").css("margin-bottom","3px");jqFn.jqGridListIcon(gridID,rid,"add");if(afterFunc!==undefined){callFunction(afterFunc)}}return false}return{version:"1.0",author:"darkhand",getCookie:getCookie,setCookie:setCookie,callFunction:callFunction,enterSend:enterSend,focusCSS:focusCSS,loadingImg:loadingImg,clearElement:clearElement,setHtmlValues:setHtmlValues,setValues:setValues,setTextValues:setTextValues,changeKeys:changeKeys,setSelectOpt:setSelectOpt,changeSelOpt:changeSelOpt,setjqGridOpt:setjqGridOpt,targetFrame:targetFrame,setOSXModal:setOSXModal,nowDate:nowDate,termDate:termDate,isMaxTermDate:isMaxTermDate,jsAddYear:jsAddYear,jsAddMonths:jsAddMonths,leadingZeros:leadingZeros,comma:comma,uncomma:uncomma,ajaxError:ajaxError,addRow:addRow}}));